(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[991],{6425:(e,t,a)=>{Promise.resolve().then(a.bind(a,7116))},7116:(e,t,a)=>{"use strict";a.r(t),a.d(t,{default:()=>d});var r=a(5155),o=a(2115),l=a(2108);let s=e=>{let{value:t,onChange:a,onBlur:o,type:l}=e,s="w-full h-full p-1 bg-transparent focus:outline-none focus:ring-2 focus:ring-blue-500 rounded";return"yesNo"===l?(0,r.jsxs)("select",{value:t||"",onChange:a,onBlur:o,autoFocus:!0,className:s,children:[(0,r.jsx)("option",{value:"",children:"-"}),(0,r.jsx)("option",{value:"yes",children:"Yes"}),(0,r.jsx)("option",{value:"no",children:"No"})]}):"number"===l||"scale"===l?(0,r.jsx)("input",{type:"number",value:t||"",onChange:a,onBlur:o,autoFocus:!0,className:"".concat(s," w-20")}):(0,r.jsx)("textarea",{value:t||"",onChange:a,onBlur:o,autoFocus:!0,className:"".concat(s," h-20"),rows:3})},d=()=>{let{data:e}=(0,l.useSession)(),[t,a]=(0,o.useState)({}),[d,n]=(0,o.useState)(null),[i,y]=(0,o.useState)(()=>{let e=new Date,t=e.getDay(),a=e.getDate()-t+(0===t?-6:1);return new Date(e.setDate(a))}),c=(0,o.useCallback)(e=>{let t=[];for(let a=0;a<7;a++){let r=new Date(e);r.setDate(e.getDate()+a),t.push(r.toISOString().split("T")[0])}return t},[]),m=(0,o.useCallback)(async t=>{let r=c(t),o={};if(e)try{let e=await fetch("/api/habits/weekly?weekStart=".concat(t.toISOString()));if(!e.ok)throw Error("Failed to fetch");let a=await e.json(),r={};for(let e of a)r[new Date(e.date).toISOString().split("T")[0]]={id:e.id,data:e.data,comments:e.comments};o=r}catch(e){console.error("Couldn't fetch data for auth user:",e)}else r.forEach(e=>{let t=localStorage.getItem("habit-data-".concat(e));t&&(o[e]={data:JSON.parse(t)})});let l={};r.forEach(e=>{l[e]=o[e]||{data:{}}}),a(l)},[e,c]);(0,o.useEffect)(()=>{m(i)},[i,m,e]);let b=async r=>{n(null);let o=t[r];if(o&&(0!==Object.keys(o.data).length||o.comments))if(e)if(o.id)await fetch("/api/habits/".concat(o.id),{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({data:o.data,comments:o.comments})});else{let e=await fetch("/api/habits",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({...o.data,comments:o.comments,date:new Date(r)})}),t=await e.json();a(e=>({...e,[r]:{...e[r],id:t.id}}))}else localStorage.setItem("habit-data-".concat(r),JSON.stringify(o.data))},x=(e,a)=>{var r;let o=null==(r=t[a])?void 0:r.data;return o?o[e]:void 0},h=e=>{var a;return(null==(a=t[e])?void 0:a.comments)||""},u=c(i);return(0,r.jsxs)("main",{className:"p-4 md:p-8",children:[(0,r.jsx)("h1",{className:"text-2xl font-bold mb-4 dark:text-white",children:"Weekly Habits Summary"}),(0,r.jsxs)("div",{className:"flex justify-between items-center mb-4",children:[(0,r.jsx)("button",{onClick:()=>{y(e=>{let t=new Date(e);return t.setDate(e.getDate()-7),t})},className:"px-4 py-2 rounded-md bg-ray-200 dark:bg-gray-700 dark:text-white",children:"Previous week"}),(0,r.jsxs)("span",{className:"text-lg font-semibold dark:text-white",children:["Week of ",i.toLocaleDateString("en-US",{month:"long",day:"numeric",year:"numeric"})]}),(0,r.jsx)("button",{onClick:()=>{y(e=>{let t=new Date(e);return t.setDate(e.getDate()+7),t})},className:"px-4 py-2 rounded-md bg-gray-200 dark:bg-gray-700 dark:text-white",children:"Next week"})]}),(0,r.jsx)("div",{className:"overflow-x-auto",children:(0,r.jsxs)("table",{className:"min-w-full border-collapse",children:[(0,r.jsx)("thead",{children:(0,r.jsxs)("tr",{children:[(0,r.jsx)("th",{className:"py-2 px-4 text-left text-sm font-semibold text-gray-600 dark:text-gray-300 border border-gray-300 dark:border-gray-600",children:"Habit"}),u.map(e=>(0,r.jsx)("th",{className:"py-2 px-4 text-left text-sm font-semibold text-gray-600 dark:text-gray-300 border border-gray-300 dark:border-gray-600",children:new Date(e+"T00:00:00").toLocaleDateString("en-US",{weekday:"short",month:"short",day:"numeric"})},e)),(0,r.jsx)("th",{className:"py-2 px-4 text-left text-sm font-semibold text-gray-600 dark:text-gray-300 border border-gray-300 dark:border-gray-600",children:"Target"}),(0,r.jsx)("th",{className:"py-2 px-4 text-left text-sm font-semibold text-gray-600 dark:text-gray-300 border border-gray-300 dark:border-gray-600",children:"Points"}),(0,r.jsx)("th",{className:"py-2 px-4 text-left text-sm font-semibold text-gray-600 dark:text-gray-300 border border-gray-300 dark:border-gray-600",children:"% of goal"})]})}),(0,r.jsxs)("tbody",{children:[[{key:"my-notes",label:"My Notes",type:"text"},{key:"ai-notes",label:"AI's Notes \uD83D\uDC4A",type:"text"},{key:"tracked-behavior",label:"Did I track my behavior on this sheet today?",type:"yesNo"},{key:"watched-video",label:"Did I watch a video for the 21 Day Challenge today?",type:"yesNo"},{key:"exercised",label:"Did I exercise today?",type:"yesNo"},{key:"exercise-plan",label:"Habit Stack: What is my exercise plan for tomorrow?",type:"text"},{key:"diet-health",label:"How healthy was my diet today?",type:"scale"},{key:"sleep-hours",label:"How many hours of sleep did I get last night?",type:"number"},{key:"sleep-on-time",label:"Am I on track to get to sleep on time tonight?",type:"yesNo"},{key:"energy-level",label:"How energized did I feel today?",type:"scale"},{key:"social-media-usage",label:"How was my social media usage today?",type:"scale"},{key:"productivity-level",label:"How productive was I today?",type:"scale"},{key:"completed-work-task",label:"Did I complete my #1 Work Task today?",type:"yesNo"},{key:"work-task-tomorrow",label:"What is my #1 Work Task for tomorrow?",type:"text"},{key:"timeboxed-schedule",label:"Habit Stack: Did I create a detailed, 30x30 minute Timeboxed Schedule for tomorrow?",type:"yesNo"},{key:"grateful-health",label:"Reflection: What's one reason to be grateful for your health and body?",type:"text"},{key:"grateful-person",label:"Reflection: Who is one person that you're grateful for today and why?",type:"text"},{key:"grateful-circumstances",label:"Reflection: What's one reason to be grateful for your circumstances?",type:"text"},{key:"attitude",label:"How was my attitude today?",type:"scale"},{key:"discipline-on-demand",label:"Habit Stack: Did I complete today's Discipline On Demand?",type:"yesNo"}].map(e=>(0,r.jsxs)("tr",{children:[(0,r.jsx)("td",{className:"py-2 px-4 text-sm text-gray-800 dark:text-gray-200 font-medium border border-gray-300 dark:border-gray-600",children:e.label}),u.map(t=>(0,r.jsx)("td",{onClick:()=>n({date:t,habit:e.key}),className:"py-0 px-0 text-sm text-gray-800 dark:text-gray-200 border border-gray-300 dark:border-gray-600 relative",children:(null==d?void 0:d.date)===t&&(null==d?void 0:d.habit)===e.key?(0,r.jsx)(s,{value:x(e.key,t),onChange:r=>((e,t,r)=>{a(a=>{let o={...a[e]||{data:{}}};return o.data={...o.data,[t]:r},{...a,[e]:o}})})(t,e.key,r.target.value),onBlur:()=>b(t),type:e.type}):(0,r.jsx)("div",{className:"w-full h-full p-2",children:String(x(e.key,t)||"-")})},t)),(0,r.jsx)("td",{className:"py-2 px-4 text-sm text-gray-800 dark:text-gray-200 border border-gray-300 dark:border-gray-600",children:"N/A"}),(0,r.jsx)("td",{className:"py-2 px-4 text-sm text-gray-800 dark:text-gray-200 border border-gray-300 dark:border-gray-600",children:"number"===e.type||"scale"===e.type?(e=>{let a=0,r=0;return Object.values(t).forEach(t=>{let o=t.data,l=o?o[e]:void 0;"string"!=typeof l||isNaN(parseFloat(l))?"number"==typeof l?(a+=l,r++):"yes"===l?(a+=1,r++):"no"===l&&r++:(a+=parseFloat(l),r++)}),r>0?(a/r).toFixed(2):"N/A"})(e.key):(e=>{let a=0;return Object.values(t).forEach(t=>{let r=t.data,o=r?r[e]:void 0;"string"!=typeof o||isNaN(parseFloat(o))?"number"==typeof o?a+=o:"yes"===o&&(a+=1):a+=parseFloat(o)}),a})(e.key)}),(0,r.jsx)("td",{className:"py-2 px-4 text-sm text-gray-800 dark:text-gray-200 border border-gray-300 dark:border-gray-600",children:"N/A"})]},e.key)),(0,r.jsxs)("tr",{children:[(0,r.jsx)("td",{className:"py-2 px-4 text-sm text-gray-800 dark:text-gray-200 font-medium border border-gray-300 dark:border-gray-600",children:"Comments"}),u.map(e=>(0,r.jsx)("td",{onClick:()=>n({date:e,habit:"comments"}),className:"py-0 px-0 text-sm text-gray-800 dark:text-gray-200 border border-gray-300 dark:border-gray-600 relative",children:(null==d?void 0:d.date)===e&&(null==d?void 0:d.habit)==="comments"?(0,r.jsx)(s,{value:h(e),onChange:t=>((e,t)=>{a(a=>({...a,[e]:{...a[e]||{data:{}},comments:t}}))})(e,t.target.value),onBlur:()=>b(e),type:"text"}):(0,r.jsx)("div",{className:"w-full h-full p-2",children:h(e)||"-"})},e)),(0,r.jsx)("td",{colSpan:3,className:"border border-gray-300 dark:border-gray-600"})]})]})]})})]})}}},e=>{e.O(0,[108,441,964,358],()=>e(e.s=6425)),_N_E=e.O()}]);