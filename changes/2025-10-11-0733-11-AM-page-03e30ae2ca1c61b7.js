(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[974],{308:(e,t,n)=>{"use strict";n.r(t),n.d(t,{default:()=>J});var r=n(5155),a=n(2115),s=n(2108),o=n(5695);let l="fireUpData",i=()=>new Date().toISOString().split("T")[0],c=(e,t)=>{let n=new Date(e+"T00:00:00Z");return(new Date(t+"T00:00:00Z").getTime()-n.getTime())/864e5},d=()=>{let e=localStorage.getItem(l);if(!e)return{currentStreak:0,lastPostDate:null};let t=JSON.parse(e);if(!t.lastPostDate)return t;let n=i();if(c(t.lastPostDate,n)>1){let e={currentStreak:0,lastPostDate:t.lastPostDate};return localStorage.setItem(l,JSON.stringify(e)),e}return t};async function u(){let e=i(),t=d();if(t.lastPostDate===e)return;let n={currentStreak:1,lastPostDate:e};t.lastPostDate&&t.currentStreak>0&&1===c(t.lastPostDate,e)&&(n.currentStreak=t.currentStreak+1),localStorage.setItem(l,JSON.stringify(n)),window.dispatchEvent(new CustomEvent("streakUpdated"))}function m(){let[e,t]=(0,a.useState)(0),{status:n}=(0,s.useSession)(),[o,l]=(0,a.useState)(!1),i=(0,a.useCallback)(async()=>{try{let e=await fetch("/api/streak");if(e.ok){let n=await e.json();t(n.streak)}else console.error("Failed to fetch streak for authenticated user.")}catch(e){console.error("Error fetching streak:",e)}},[]),c=(0,a.useCallback)(()=>{t(d().currentStreak)},[]),u=(0,a.useCallback)(()=>{o&&("authenticated"===n?i():"unauthenticated"===n&&c())},[o,n,i,c]);(0,a.useEffect)(()=>{l(!0)},[]),(0,a.useEffect)(()=>{if(!o)return;u();let e=()=>{"unauthenticated"===n&&c()};return window.addEventListener("streakUpdated",u),window.addEventListener("storage",e),()=>{window.removeEventListener("streakUpdated",u),window.removeEventListener("storage",e)}},[o,n,u,c]);let m=e>0?"You're on a ".concat(e,"-day streak! Keep it up!"):"Start your streak today!";return(0,r.jsxs)("h1",{className:"flex items-center justify-center gap-2 font-extrabold text-gray-100 text-center w-full px-2 relative group",style:{fontSize:"clamp(1rem, 4vw, 2.25rem)"},children:["JourIn: Journal Your Way to Impact \uD83D\uDD25 ",e,(0,r.jsx)("div",{className:"absolute bottom-full left-1/2 -translate-x-1/2 mb-2 px-3 py-1 bg-gray-700 text-gray-100 text-xs rounded-md opacity-0 group-hover:opacity-100 transition-opacity duration-300 whitespace-nowrap pointer-events-none",children:m})]})}function f(){let{data:e}=(0,s.useSession)(),t=(0,o.useRouter)();return(0,r.jsxs)("div",{className:"max-w-md w-full space-y-8 text-center",children:[(0,r.jsx)("div",{className:"flex justify-between items-center",children:(0,r.jsx)(m,{})}),(0,r.jsx)("div",{className:"flex justify-center mb-4",children:e?(0,r.jsx)("button",{onClick:()=>(0,s.signOut)(),className:"bg-red-600 hover:bg-red-700 text-white text-sm py-1 px-2 rounded",children:"Logout"}):(0,r.jsx)("button",{onClick:()=>t.push("/auth"),className:"text-white text-2xl p-2 rounded-full hover:bg-gray-700 focus:outline-none focus:ring-2 focus:ring-gray-600","aria-label":"Login or Register",children:"\uD83D\uDD11"})}),(0,r.jsx)("p",{className:"mt-2 text-lg text-gray-300",children:"Transform your personal reflections into powerful, shareable insights for your professional network. Reflect, refine, and connect with your community."})]})}function g(e){let{initialValue:t,onSave:n,onFocus:s,onBlur:o,placeholder:l}=e,[i,c]=(0,a.useState)(!1),[d,u]=(0,a.useState)(t),[m,f]=(0,a.useState)(!1),g=(0,a.useRef)(null);return(0,a.useEffect)(()=>{u(t)},[t]),(0,a.useEffect)(()=>{i&&g.current&&(g.current.focus(),g.current.select())},[i]),(0,r.jsx)("span",{onMouseEnter:()=>f(!0),onMouseLeave:()=>f(!1),onDoubleClick:()=>{c(!0)},className:"cursor-pointer relative block w-full",children:i?(0,r.jsx)("input",{ref:g,type:"text",value:d,onChange:e=>{u(e.target.value)},onFocus:s,onBlur:()=>{c(!1),d!==t&&n(d),o&&o()},onKeyDown:e=>{"Enter"===e.key?(c(!1),d!==t&&n(d)):"Escape"===e.key&&(u(t),c(!1))},className:"bg-gray-700 text-gray-100 border border-gray-600 rounded-md p-1 text-sm font-medium w-full",autoFocus:!0,"aria-label":"Edit ".concat(t),placeholder:l||"Write your question"}):(0,r.jsxs)("span",{className:"\n          block w-full p-1 rounded-md\n          ".concat(""===d.trim()?"text-gray-400 italic":"text-gray-100","\n          ").concat(m?"hover:text-indigo-400 transition-colors duration-200":"","\n        "),children:[""===d.trim()?l||"Write your question":d,m&&(0,r.jsx)("span",{className:"absolute left-full top-1/2 -translate-y-1/2 ml-2 text-gray-500 text-xs italic whitespace-nowrap",children:"(Double-click to edit)"})]})})}var h=n(6671);function p(e){let{journalEntries:t,onJournalEntriesChange:n,customTitles:s,onCustomTitleChange:o,additionalFields:l,setAdditionalFields:i}=e,[c,d]=(0,a.useState)(null),[u,m]=(0,a.useState)(null),[f,p]=(0,a.useState)({}),{showReward:x}={showReward:e=>{h.o.success(e)}},y=e=>{let{name:r,value:a}=e.target;n({...t,[r]:a})},b=()=>{let e="customField_".concat(l.length);i([...l,e]),x("New field added!")},w=(e,n,a)=>{let s=c===e,l=t[e]&&"string"==typeof t[e]&&t[e].length>0;return(0,r.jsxs)("div",{className:"relative",onMouseEnter:()=>d(e),onMouseLeave:()=>d(null),children:[(0,r.jsx)("label",{htmlFor:e,className:"block text-sm font-medium text-gray-300 text-center",children:(0,r.jsx)(g,{initialValue:a,onSave:t=>o(e,t),fieldKey:e})}),(0,r.jsx)("div",{className:"mt-1",children:(0,r.jsx)("textarea",{id:e,name:e,rows:4,className:"shadow-sm focus:ring-indigo-500 focus:border-indigo-500 mt-1 block w-full sm:text-sm border border-gray-600 rounded-md p-2 bg-gray-700 text-gray-100",placeholder:n,value:t[e]||"",onChange:y})}),s&&!l&&(0,r.jsx)("button",{type:"button",onClick:b,className:"absolute top-0 right-0 mt-1 mr-1 w-6 h-6 bg-gray-600 rounded-full text-white hover:bg-gray-500 flex items-center justify-center",children:"+"})]})};return(0,r.jsx)("div",{className:"mt-8",children:(0,r.jsxs)("form",{className:"space-y-6",children:[w("whatWentWell","Reflect on your achievements and positive experiences...",s.whatWentWell),w("whatILearned","Jot down new insights, skills, or knowledge gained...",s.whatILearned),w("whatWouldDoDifferently","Consider areas for improvement and alternative approaches...",s.whatWouldDoDifferently),w("nextStep","Outline the specific actions you’ll take tomorrow or in the near future based on today’s experiences...",s.nextStep),l.map(e=>{let a=t["".concat(e,"_title")]||"New Field",s=c===e,o=u===e;return(0,r.jsxs)("div",{className:"relative",onMouseEnter:()=>d(e),onMouseLeave:()=>d(null),children:[(0,r.jsx)("label",{htmlFor:e,className:"block text-sm font-medium text-gray-300 text-center",children:(0,r.jsx)(g,{initialValue:a,onSave:r=>{p(t=>{let n={...t};return delete n[e],n}),n({...t,["".concat(e,"_title")]:r})},fieldKey:e,onFocus:()=>{m(e),p(t=>{let n={...t};return delete n[e],n})},onBlur:()=>m(null),placeholder:"Write your question"})}),f[e]&&(0,r.jsx)("p",{className:"text-red-500 text-xs mt-1",children:f[e]}),(0,r.jsx)("div",{className:"mt-1",children:(0,r.jsx)("textarea",{id:e,name:e,rows:4,className:"shadow-sm focus:ring-indigo-500 focus:border-indigo-500 mt-1 block w-full sm:text-sm border border-gray-600 rounded-md p-2 bg-gray-700 text-gray-100",placeholder:"Description",value:t[e]||"",onChange:y,onFocus:()=>m(e),onBlur:()=>m(null)})}),s&&!o&&(0,r.jsx)("button",{type:"button",onClick:()=>(e=>{i(l.filter(t=>t!==e));let r={...t};delete r[e],delete r["".concat(e,"_title")],n(r),x("Field removed!")})(e),className:"absolute top-0 right-0 mt-1 mr-1 w-6 h-6 bg-red-600 rounded-full text-white hover:bg-red-500 flex items-center justify-center",children:"-"})]},e)})]})})}function x(e){let{onClick:t,disabled:n}=e;return(0,r.jsx)("button",{type:"button",onClick:t,disabled:n,className:"w-full flex justify-center py-2 px-4 border border-transparent rounded-md shadow-sm text-sm font-medium text-white bg-indigo-700 hover:bg-indigo-800 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500 disabled:bg-gray-500 disabled:cursor-not-allowed",children:"Generate Post Prompt"})}let y='\nBased on my daily journal entries below, please generate a professional and engaging LinkedIn post.\n\nThe post should be a complete, seamless text, ready to be published. It should implicitly follow a "Hook → Re-hook → Body → CTA" structure, but do not label the sections.\n\nTone: Reflective, inspiring, and professional. Write as if sharing a personal growth moment with fellow professionals.\n\nCrucially, end the post with 3-5 relevant and popular hashtags related to professional growth, reflection, or the topics in the journal entries.\n\nEnsure:\n- The post flows naturally as a single piece of text.\n- No confidential or sensitive information is included.\n- Avoid providing private details.\n- Insights are actionable and relatable to a wide professional audience.\n- The post is clear and engaging, with short paragraphs and line breaks.\n- Length: Around 40–120 words (excluding hashtags).\n\nHere are my journal entries for today:\n\n{{journalEntries}}\n{{goalSection}}\n---\nLinkedIn Post Structure Guidelines:\n- Hook: A bold, emotional, or thought-provoking first line.\n- Re-hook: A question or strong statement that encourages further reading.\n- Body/Value: Specific insights, lessons learned, or details of success.\n- CTA: End with an invitation for comments, shares, or discussion.\n----\n\nPlease generate the LinkedIn post now.\n',b=e=>{let{initialTemplate:t,onSave:n,onClose:s}=e,[o,l]=(0,a.useState)(t);return(0,a.useEffect)(()=>{l(t)},[t]),(0,r.jsx)("div",{className:"fixed inset-0 bg-black/60 dark:bg-black/80 flex justify-center items-center p-4 z-50",children:(0,r.jsxs)("div",{className:"bg-white dark:bg-gray-900 rounded-lg shadow-xl p-6 w-full max-w-2xl border border-gray-200 dark:border-gray-700",children:[(0,r.jsxs)("div",{className:"flex justify-between items-center mb-4",children:[(0,r.jsx)("h2",{className:"text-xl font-bold text-gray-900 dark:text-gray-100",children:"Customize the Prompt Template"}),(0,r.jsx)("button",{onClick:s,className:"text-gray-500 dark:text-gray-400 hover:text-gray-800 dark:hover:text-gray-200 transition","aria-label":"Close",children:"\xd7"})]}),(0,r.jsxs)("p",{className:"text-sm text-gray-600 dark:text-gray-400 mb-4",children:["Edit the template for generating LinkedIn posts. Use placeholders like"," ",(0,r.jsx)("code",{className:"bg-gray-100 dark:bg-gray-800 text-gray-800 dark:text-gray-200 px-1 rounded",children:"{{whatWentWell}}"})," ","to insert your journal entries."]}),(0,r.jsx)("textarea",{"aria-label":"Customize Prompt Template",className:"w-full h-64 p-2 border border-gray-300 dark:border-gray-700 rounded-md font-mono text-sm bg-white dark:bg-gray-800 text-gray-900 dark:text-gray-100 focus:outline-none focus:ring-2 focus:ring-blue-500",value:o,onChange:e=>l(e.target.value)}),(0,r.jsxs)("div",{className:"flex justify-between items-center mt-4",children:[(0,r.jsx)("button",{onClick:()=>{l(y)},className:"text-sm text-blue-600 dark:text-blue-400 hover:underline",children:"Reset to default"}),(0,r.jsxs)("div",{className:"flex gap-2",children:[(0,r.jsx)("button",{onClick:s,className:"px-4 py-2 rounded-md text-gray-700 dark:text-gray-200 bg-gray-200 dark:bg-gray-700 hover:bg-gray-300 dark:hover:bg-gray-600 transition",children:"Cancel"}),(0,r.jsx)("button",{onClick:()=>{n(o),s()},className:"px-4 py-2 rounded-md text-white bg-blue-600 hover:bg-blue-700 transition",children:"Save template"})]})]})]})})};var w=n(2043);let j={whatWentWell:"What went well today",whatILearned:"What I learned today",whatWouldDoDifferently:"What I would do differently",nextStep:"What's my next step?"},v=function(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:y,r={...j,...t},a=Object.keys(e).filter(t=>{if("userGoal"===t||t.endsWith("_title")||"customTitles"===t||"promptTemplate"===t||"timestamp"===t)return!1;let n=e[t];return"string"==typeof n?""!==n.trim():!!n}).map(t=>{let n=e["".concat(t,"_title")]||r[t]||t,a=e[t];return"".concat(n,": ").concat(a)}).join("\n\n");if(!a)throw Error("Please fill out at least one journal entry to generate a prompt.");let s="";e.userGoal&&(s="\n\nUser's Goal for this post: ".concat(e.userGoal,". Please tailor the tone and content of the LinkedIn post to align with this goal, making it relevant and appealing to an audience that can help achieve it."));let o=n.replace(/{{journalEntries}}/g,a).replace(/{{goalSection}}/g,s);for(let t in e)if(Object.prototype.hasOwnProperty.call(e,t)){let n=e[t];if("string"==typeof n){let e=RegExp("{{".concat(t,"}}"),"g");o=o.replace(e,n)}}return o};function S(e){let{onClick:t,disabled:n}=e;return(0,r.jsx)("button",{type:"button",onClick:t,disabled:n,className:"w-full flex justify-center py-2 px-4 border border-transparent rounded-md shadow-sm text-sm font-medium text-white bg-green-700 hover:bg-green-800 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-green-500 disabled:bg-gray-500 disabled:cursor-not-allowed",children:"Generate Post"})}function k(e){let{post:t}=e,[n,s]=(0,a.useState)(!0),[o,l]=(0,a.useState)("");return t?(0,r.jsxs)("div",{className:"mt-8 p-4 bg-gray-700 rounded-md shadow-md text-left",children:[(0,r.jsxs)("div",{className:"flex justify-between items-center",children:[(0,r.jsx)("h2",{className:"text-lg font-medium text-gray-100",children:"Generated Post:"}),(0,r.jsx)("button",{onClick:()=>s(!n),className:"px-3 py-1 border border-transparent rounded-md shadow-sm text-sm font-medium text-white bg-gray-600 hover:bg-gray-500 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-gray-500",children:n?"Hide":"Show"})]}),n&&(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)("pre",{className:"mt-2 whitespace-pre-wrap text-sm text-gray-300",children:t}),(0,r.jsxs)("div",{className:"mt-4 flex items-center justify-between",children:[(0,r.jsx)("button",{onClick:()=>{navigator.clipboard.writeText(t).then(()=>{l("Copied!"),setTimeout(()=>l(""),2e3)},()=>{l("Failed to copy"),setTimeout(()=>l(""),2e3)})},className:"inline-flex items-center px-4 py-2 border border-transparent rounded-md shadow-sm text-sm font-medium text-white bg-green-600 hover:bg-green-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-green-500",children:"Copy Post"}),o&&(0,r.jsx)("span",{className:"ml-3 text-sm text-green-400 font-medium",children:o})]})]})]}):null}let N={whatWentWell:"What went well today?",whatILearned:"What did I learn today?",whatWouldDoDifferently:"What would I do differently?",nextStep:"What’s my next step?"};function D(e){let{onPromptGenerated:t}=e,{status:n}=(0,s.useSession)(),[o,l]=(0,a.useState)({whatWentWell:"",whatILearned:"",whatWouldDoDifferently:"",nextStep:""}),[i,c]=(0,a.useState)(""),[d,u]=(0,a.useState)(N),[m,f]=(0,a.useState)(y),[g,h]=(0,a.useState)(!1),[j,D]=(0,a.useState)(!1),[T,C]=(0,a.useState)([]),[W,E]=(0,a.useState)("");(0,a.useEffect)(()=>{let e=localStorage.getItem("jourin_current_draft");if(e)try{l(JSON.parse(e))}catch(e){console.error("Failed to parse saved draft from localStorage",e)}let t=localStorage.getItem("jourin_user_goal");if(t)try{c(JSON.parse(t))}catch(e){console.error("Failed to parse saved user goal from localStorage",e)}let n=localStorage.getItem("jourin_custom_titles");if(n)try{u(JSON.parse(n))}catch(e){console.error("Failed to parse saved custom titles from localStorage",e)}let r=localStorage.getItem("jourin_prompt_template");r&&f(r);let a=localStorage.getItem("jourin_additional_fields");if(a)try{C(JSON.parse(a))}catch(e){console.error("Failed to parse saved additional fields from localStorage",e)}D(!0)},[]);let _=(0,w.s)(e=>{localStorage.setItem("jourin_current_draft",JSON.stringify(e))},500),I=(0,w.s)(e=>{localStorage.setItem("jourin_user_goal",JSON.stringify(e))},500),F=(0,a.useCallback)(e=>{localStorage.setItem("jourin_custom_titles",JSON.stringify(e))},[]),P=(0,a.useCallback)(e=>{localStorage.setItem("jourin_additional_fields",JSON.stringify(e))},[]);(0,a.useEffect)(()=>{j&&F(d)},[d,F,j]),(0,a.useEffect)(()=>{j&&P(T)},[T,P,j]);let L=async()=>{try{let e=await fetch("/api/generate/db",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({userGoal:i,promptTemplate:m})});if(!e.ok)throw Error("Failed to generate post");let{post:t}=await e.json();E(t);let n={whatWentWell:"",whatILearned:"",whatWouldDoDifferently:"",nextStep:""};T.forEach(e=>{let t="".concat(e,"_title");o[t]&&(n[t]=o[t])}),localStorage.setItem("jourin_current_draft",JSON.stringify(n)),l(n)}catch(e){console.error("Error generating post:",e)}};if(!j)return(0,r.jsx)("div",{children:"Loading..."});let O=Object.values(o).every(e=>"string"==typeof e&&""===e.trim());return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(p,{journalEntries:o,onJournalEntriesChange:e=>{l(e),_(e)},customTitles:d,onCustomTitleChange:(e,t)=>{u(n=>({...n,[e]:t}))},additionalFields:T,setAdditionalFields:C}),(0,r.jsx)("div",{className:"mt-8",children:(0,r.jsx)("div",{className:"mt-4 space-y-4",children:(0,r.jsx)("div",{children:(0,r.jsx)("textarea",{id:"userGoal",name:"userGoal",rows:3,className:"shadow-sm focus:ring-indigo-500 focus:border-indigo-500 mt-1 block w-full sm:text-sm border border-gray-600 rounded-md p-2 bg-gray-700 text-gray-100",placeholder:"What's your goal? (e.g., 'Find a full-stack position', 'Build a following for my tech blog')",value:i,onChange:e=>{let t=e.target.value;c(t),I(t)}})})})}),(0,r.jsxs)("div",{className:"mt-6 flex flex-col items-center",children:[(0,r.jsx)(x,{onClick:()=>{let e=new Set(["whatWentWell","whatILearned","whatWouldDoDifferently","nextStep"]);for(let t in o)if(Object.prototype.hasOwnProperty.call(o,t)){let n=o[t];if(t.endsWith("_title"))continue;let r="";if(r=e.has(t)?d[t]||"":o["".concat(t,"_title")]||"","string"==typeof n&&""!==n.trim()&&""===r.trim())return void alert('Please provide a title for the entry: "'.concat(n,'"'))}try{let e=v({...o,userGoal:i},d,m),n={...d};for(let e in o)if(Object.prototype.hasOwnProperty.call(o,e)&&e.endsWith("_title")){n[e]=o[e];let t=e.replace(/_title$/,"");o[t]&&(n[t]=o[t])}console.log("Final allCustomTitles being passed to onPromptGenerated:",n),t(e,{...o,userGoal:i},n);let r={whatWentWell:"",whatILearned:"",whatWouldDoDifferently:"",nextStep:""};T.forEach(e=>{let t="".concat(e,"_title");o[t]&&(r[t]=o[t])}),localStorage.setItem("jourin_current_draft",JSON.stringify(r)),l(r)}catch(e){e instanceof Error&&alert(e.message)}},disabled:O}),"unauthenticated"===n&&(0,r.jsx)("a",{href:"/auth",className:"mt-4 w-full",children:(0,r.jsx)("button",{className:"w-full flex justify-center py-2 px-4 border border-transparent rounded-md shadow-sm text-sm font-medium text-white bg-green-700 hover:bg-green-800  focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-green-500",children:"Log in to Generate a Post"})}),"authenticated"===n&&(0,r.jsx)("div",{className:"mt-4 w-full",children:(0,r.jsx)(S,{onClick:L,disabled:O})}),(0,r.jsx)("button",{onClick:()=>h(!0),className:"mt-2 text-sm text-blue-500 hover:underline",children:"Customize Prompt"})]}),W&&(0,r.jsx)(k,{post:W}),g&&(0,r.jsx)(b,{initialTemplate:m,onSave:e=>{f(e),localStorage.setItem("jourin_prompt_template",e),h(!1)},onClose:()=>h(!1)})]})}function T(e){let{prompt:t,onCopy:n,copySuccess:s}=e,[o,l]=(0,a.useState)(!0);return(0,r.jsxs)("div",{className:"mt-8 p-4 bg-gray-700 rounded-md shadow-md text-left",children:[(0,r.jsxs)("div",{className:"flex justify-between items-center",children:[(0,r.jsx)("h2",{className:"text-lg font-medium text-gray-100",children:"Generated Prompt"}),(0,r.jsx)("button",{onClick:()=>l(!o),className:"px-3 py-1 border border-transparent rounded-md shadow-sm text-sm font-medium text-white bg-gray-600 hover:bg-gray-500 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-gray-500",children:o?"Hide":"Show"})]}),o&&(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)("pre",{className:"mt-2 whitespace-pre-wrap text-sm text-gray-300",children:t}),(0,r.jsxs)("div",{className:"mt-4 flex items-center justify-between",children:[(0,r.jsx)("button",{onClick:n,className:"inline-flex items-center px-4 py-2 border border-transparent rounded-md shadow-sm text-sm font-medium text-white bg-green-600 hover:bg-green-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-green-500",children:"Copy Prompt"}),s&&(0,r.jsx)("span",{className:"ml-3 text-sm text-green-400 font-medium",children:s})]})]})]})}function C(e){let t=new Date(e),n=t.getDay(),r=t.getDate()-n;return t.setDate(r),t.setHours(0,0,0,0),t}function W(e){let t=new Date(C(e));return t.setDate(t.getDate()+6),t.setHours(23,59,59,999),t}let E=e=>{let{entry:t}=e,[n,s]=(0,a.useState)(null),[o,l]=(0,a.useState)(null),i=()=>{let e=[],n={...j,...t.customTitles},r=new Set;return Object.keys(t).filter(e=>{if("timestamp"===e||"customTitles"===e||e.endsWith("_title")||"userGoal"===e)return!1;let n=t[e];return"string"==typeof n?""!==n.trim():!!n}).forEach(a=>{if(!r.has(a)){let s=t["".concat(a,"_title")]||n[a]||a,o=t[a]||"";e.push({key:a,value:o,title:s}),r.add(a)}}),t.customTitles&&"object"==typeof t.customTitles&&Object.keys(t.customTitles).filter(e=>{let n=t.customTitles[e];return e.startsWith("customField_")&&!e.endsWith("_title")&&null!=n}).forEach(n=>{if(!r.has(n)){let a=t[n]||"",s="".concat(n,"_title"),o=t.customTitles[s]||t[s]||n;a&&""!==a.trim()&&(e.push({key:n,value:a,title:o}),r.add(n))}}),e},c=async()=>{let e=v(t,t.customTitles||{},t.promptTemplate);try{await navigator.clipboard.writeText(e),s(t.timestamp),setTimeout(()=>s(null),2e3)}catch(e){console.error("Failed to copy past entry prompt: ",e)}},d=async()=>{let e=i().map(e=>"".concat(e.title,":\n").concat(e.value)).join("\n\n"),n="--- Journal Entry (".concat(new Date(t.timestamp).toLocaleString(),") ---\n").concat(e);try{await navigator.clipboard.writeText(n),l(t.timestamp),setTimeout(()=>l(null),2e3)}catch(e){console.error("Failed to copy past entry text: ",e)}},u=i();return(0,r.jsxs)("div",{className:"p-4 bg-gray-700 rounded-md shadow-md",children:[(0,r.jsxs)("div",{className:"flex justify-between items-center mb-2",children:[(0,r.jsxs)("h3",{className:"text-md font-semibold text-gray-100",children:["Entry from ",new Date(t.timestamp).toLocaleString()]}),(0,r.jsxs)("div",{className:"flex space-x-2",children:[(0,r.jsx)("button",{onClick:c,className:"inline-flex items-center px-3 py-1 border border-transparent text-xs font-medium rounded-md shadow-sm text-white bg-purple-600 hover:bg-purple-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-purple-500",children:n===t.timestamp?"Copied!":"Copy Prompt"}),(0,r.jsx)("button",{onClick:d,className:"inline-flex items-center px-3 py-1 border border-transparent text-xs font-medium rounded-md shadow-sm text-white bg-blue-600 hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500",children:o===t.timestamp?"Copied!":"Copy Text"})]})]}),u.map(e=>(0,r.jsxs)("p",{className:"text-sm text-gray-300",children:[(0,r.jsxs)("span",{className:"font-medium",children:[e.title,":"]})," ",e.value]},e.key))]},t.timestamp)},_=function(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:y,r={...j,...t},a=e.dynamicFields?Object.keys(e.dynamicFields).map(t=>{let n=r[t]||t,a=e.dynamicFields[t];return"".concat(n,": ").concat(a)}).join("\n\n"):"";if(!a)throw Error("Please fill out at least one journal entry to generate a prompt.");let s="";e.userGoal&&(s="\n\nUser's Goal for this post: ".concat(e.userGoal,". Please tailor the tone and content of the LinkedIn post to align with this goal, making it relevant and appealing to an audience that can help achieve it."));let o=n.replace(/{{journalEntries}}/g,a).replace(/{{goalSection}}/g,s);for(let t in e)if(Object.prototype.hasOwnProperty.call(e,t)){let n=e[t];if("string"==typeof n){let e=RegExp("{{".concat(t,"}}"),"g");o=o.replace(e,n)}}return o},I=e=>{let{entry:t}=e,[n,s]=(0,a.useState)(null),[o,l]=(0,a.useState)(null),i=()=>{let e=[];({...j,...t.customTitles||{}});let n=new Set;["whatWentWell","whatILearned","whatWouldDoDifferently","nextStep"].forEach(r=>{let a=t[r];if(a&&""!==a.trim()&&!n.has(r)){let s=t.customTitles&&t.customTitles[r]?t.customTitles[r]:j[r];e.push({key:r,value:a,title:s}),n.add(r)}});let r=t.dynamicFields;return r&&"object"==typeof r&&Object.keys(r).forEach(a=>{let s=r[a],o=t.customTitles&&t.customTitles["".concat(a,"_title")]?t.customTitles["".concat(a,"_title")]:a;s&&""!==s.trim()&&!n.has(a)&&(e.push({key:a,value:s,title:o}),n.add(a))}),e},c=async()=>{let e=_(t,t.customTitles||{},t.promptTemplate);try{await navigator.clipboard.writeText(e),s(t.timestamp),setTimeout(()=>s(null),2e3)}catch(e){console.error("Failed to copy past entry prompt: ",e)}},d=async()=>{let e=i().map(e=>"".concat(e.title,":\n").concat(e.value)).join("\n\n"),n="--- Journal Entry (".concat(new Date(t.timestamp).toLocaleString(),") ---\n").concat(e);try{await navigator.clipboard.writeText(n),l(t.timestamp),setTimeout(()=>l(null),2e3)}catch(e){console.error("Failed to copy past entry text: ",e)}},u=i();return(0,r.jsxs)("div",{className:"p-4 bg-gray-700 rounded-md shadow-md",children:[(0,r.jsxs)("div",{className:"flex justify-between items-center mb-2",children:[(0,r.jsxs)("h3",{className:"text-md font-semibold text-gray-100",children:["Entry from ",new Date(t.timestamp).toLocaleString()]}),(0,r.jsxs)("div",{className:"flex space-x-2",children:[(0,r.jsx)("button",{onClick:c,className:"inline-flex items-center px-3 py-1 border border-transparent text-xs font-medium rounded-md shadow-sm text-white bg-purple-600 hover:bg-purple-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-purple-500",children:n===t.timestamp?"Copied!":"Copy Prompt"}),(0,r.jsx)("button",{onClick:d,className:"inline-flex items-center px-3 py-1 border border-transparent text-xs font-medium rounded-md shadow-sm text-white bg-blue-600 hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500",children:o===t.timestamp?"Copied!":"Copy Text"})]})]}),u.map(e=>(0,r.jsxs)("p",{className:"text-sm text-gray-300",children:[(0,r.jsxs)("span",{className:"font-medium",children:[e.title,":"]})," ",e.value]},e.key))]},t.timestamp)},F=e=>{let{entry:t}=e,{data:n}=(0,s.useSession)();return n?(0,r.jsx)(I,{entry:t}):(0,r.jsx)(E,{entry:t})};function P(e){let{newEntryToHistory:t}=e,[n,o]=(0,a.useState)(""),[l,i]=(0,a.useState)(5),[c,d]=(0,a.useState)(C(new Date)),[u,m]=(0,a.useState)(W(new Date)),[f,g]=(0,a.useState)(!1),[h,p]=(0,a.useState)(""),[x,y]=(0,a.useState)(!1),{data:b}=(0,s.useSession)(),{pastEntries:w,addJournalEntry:v}=function(){let[e,t]=(0,a.useState)([]);return(0,a.useEffect)(()=>{{let e=localStorage.getItem("jourin_past_entries");if(e)try{t(JSON.parse(e))}catch(e){console.error("Failed to parse past entries from localStorage",e),localStorage.removeItem("jourin_past_entries")}}},[]),{pastEntries:e,addJournalEntry:e=>{t(t=>{let n=[e,...t].slice(0,100);return localStorage.setItem("jourin_past_entries",JSON.stringify(n)),n})}}}(),{pastEntries:S,addJournalEntry:k}=function(){let[e,t]=(0,a.useState)([]);return(0,a.useEffect)(()=>{(async()=>{let e=await fetch("/api/journal");if(e.ok){let n=await e.json();console.log("Raw entries from API:",n);let r=(Array.isArray(n)?n:[]).map(e=>{console.log("Processing entry:",e),console.log("Entry customTitles:",e.customTitles);let t={...e,whatWentWell:e.whatWentWell||"",whatILearned:e.whatILearned||"",whatWouldDoDifferently:e.whatWouldDoDifferently||"",nextStep:e.nextStep||"",customTitles:e.customTitles||{},timestamp:new Date(e.createdAt).getTime()};return console.log("Formatted entry:",t),t});console.log("Final formatted entries:",r),t(r)}else console.error("Failed to fetch entries:",e.status,e.statusText)})()},[]),{pastEntries:e,addJournalEntry:(0,a.useCallback)(async e=>{console.log("Adding new entry to DB:",e);{let n={...e};n.customTitles||(n.customTitles={});let r=n.customTitles;Object.keys(n).forEach(e=>{e.endsWith("_title")&&e.startsWith("customField_")&&"string"==typeof n[e]&&(r[e]=n[e],console.log("Added title ".concat(e,": ").concat(n[e]," to customTitles")))}),console.log("CustomTitles before processing:",n.customTitles),console.log("Processed entry for DB:",n);let a=await fetch("/api/journal",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(n)});if(a.ok){let e=await a.json();console.log("Created entry response:",e);let n={...e,whatWentWell:e.whatWentWell||"",whatILearned:e.whatILearned||"",whatWouldDoDifferently:e.whatWouldDoDifferently||"",nextStep:e.nextStep||"",customTitles:e.customTitles||{},timestamp:new Date(e.createdAt).getTime()};console.log("Formatted entry to add to state:",n),t(e=>[n,...e])}else console.error("Failed to create entry:",a.status,a.statusText)}},[])}}(),N=b?S:w,D=b?k:v;(0,a.useEffect)(()=>{t&&D(t)},[t]);let T=async()=>{let e=N.map(e=>{let t={...j,...e.customTitles},n=Object.keys(e).filter(t=>{if("timestamp"===t||"customTitles"===t||t.endsWith("_title"))return!1;let n=e[t];return"string"==typeof n?""!==n.trim():!!n}).map(n=>{let r=e["".concat(n,"_title")]||t[n]||n,a=e[n];return"".concat(r,":\n").concat(a)}).join("\n\n");return"--- Journal Entry (".concat(new Date(e.timestamp).toLocaleString(),") ---\n").concat(n)}).join("\n\n");try{await navigator.clipboard.writeText(e),o("History copied!"),setTimeout(()=>o(""),2e3)}catch(e){o("Failed to copy the history!"),console.error("Failed to copy history: ",e)}};return N.length>0&&(0,r.jsxs)("div",{className:"mt-12 w-full max-w-md text-left",children:[(0,r.jsxs)("div",{className:"mb-8 p-4 bg-gray-800 rounded-md shadow-lg",children:[(0,r.jsx)("h2",{className:"text-2xl font-extrabold text-gray-100 mb-4",children:"Weekly Summary"}),(0,r.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[(0,r.jsx)("button",{onClick:()=>{let e=new Date(c);e.setDate(e.getDate()-7),d(C(e)),m(W(e))},className:"px-1 py-1 border border-transparent text-xs font-medium rounded-md shadow-sm text-white bg-indigo-600 hover:bg-indigo-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500",children:"Previous Week"}),(0,r.jsxs)("span",{className:"text-gray-100 font-semibold",children:[c.toLocaleDateString()," - ",u.toLocaleDateString()]}),(0,r.jsx)("button",{onClick:()=>{let e=new Date(c);e.setDate(e.getDate()+7),d(C(e)),m(W(e))},className:"px-1 py-1 border border-transparent text-sm font-medium rounded-md shadow-sm text-white bg-indigo-600 hover:bg-indigo-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500",children:"Next Week"})]}),(0,r.jsx)("button",{onClick:()=>{p(function(e,t,n){let r=e.filter(e=>{let r=new Date(e.timestamp);return r>=t&&r<=n});return 0===r.length?"No journal entries found for this week.":r.map(e=>{let t=e.customTitles||j;return"\n---\nJournal Entry (".concat(new Date(e.timestamp).toLocaleDateString(),") ---\n").concat(t.whatWentWell,": ").concat(e.whatWentWell,"\n").concat(t.whatILearned,": ").concat(e.whatILearned,"\n").concat(t.whatWouldDoDifferently,": ").concat(e.whatWouldDoDifferently,"\n").concat(t.nextStep,": ").concat(e.nextStep,"\n")}).join("\n\n")}(N,c,u)),g(!0)},className:"w-full px-4 py-2 border border-transparent text-base font-medium rounded-md shadow-sm text-white bg-green-600 hover:bg-green-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-green-500",children:"Generate Weekly Summary"})]}),(0,r.jsx)("h2",{className:"text-2xl font-extrabold text-gray-100 mb-4",children:"Your Past Entries"}),(0,r.jsx)("div",{className:"space-y-6",children:N.slice(0,l).map(e=>(0,r.jsx)(F,{entry:e},e.timestamp))}),(0,r.jsxs)("div",{className:"mt-6 flex items-center justify-between",children:[(0,r.jsx)("button",{onClick:T,className:"inline-flex items-center px-4 py-2 border border-transparent text-sm font-medium rounded-md shadow-sm text-white bg-blue-600 hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500",children:"Copy All History"}),n&&(0,r.jsx)("span",{className:"ml-3 text-sm text-blue-400 font-medium",children:n})]}),(0,r.jsxs)("div",{className:"mt-4 flex justify-center space-x-4",children:[l<N.length&&(0,r.jsx)("button",{onClick:()=>{i(e=>e+5)},className:"inline-flex items-center px-4 py-2 border border-transparent text-sm font-medium rounded-md shadow-sm text-gray-100 bg-gray-600 hover:bg-gray-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-gray-500",children:"Show More"}),l>5&&(0,r.jsx)("button",{onClick:()=>{i(5)},className:"inline-flex items-center px-4 py-2 border border-transparent text-sm font-medium rounded-md shadow-sm text-gray-100 bg-gray-600 hover:bg-gray-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-gray-500",children:"Show Less"})]}),N.length>5&&(0,r.jsxs)("p",{className:"mt-4 text-sm text-gray-300",children:["Showing ",Math.min(l,N.length)," of ",N.length," entries"]}),f&&(0,r.jsx)("div",{className:"fixed inset-0 bg-gray-900 bg-opacity-75 flex items-center justify-center z-50",role:"dialog","aria-label":"Weekly Summary",children:(0,r.jsxs)("div",{className:"bg-gray-700 p-6 rounded-lg shadow-xl max-w-lg w-full m-4",children:[(0,r.jsx)("h3",{className:"text-xl font-bold text-gray-100 mb-4",children:"Weekly Summary"}),(0,r.jsx)("textarea",{className:"w-full h-64 p-3 bg-gray-800 text-gray-200 rounded-md border border-gray-600 focus:outline-none focus:border-blue-500",value:h,onChange:e=>p(e.target.value)}),(0,r.jsxs)("div",{className:"mt-4 flex justify-end space-x-3",children:[(0,r.jsx)("button",{onClick:()=>{navigator.clipboard.writeText(h),y(!0),setTimeout(()=>y(!1),2e3)},className:"px-4 py-2 bg-blue-600 text-white rounded-.md hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500",children:x?"Copied!":"Copy to Clipboard"}),(0,r.jsx)("button",{onClick:()=>g(!1),className:"px-4 py-2 bg-red-600 text-white rounded-md hover:bg-red-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-red-500",children:"Close"})]})]})})]})}let L=[{days:7,message:"Congratulations! You've hit a 7-day streak. Keep up the great work!"},{days:30,message:"Amazing! A 30-day streak. You're building incredible habits!"},{days:365,message:"Unbelievable! A full-year streak. Your dedication is truly inspiring!"},{days:1461,message:"Four years! You are a legend. Your consistency is unmatched!"}];function O(e){let{streak:t,onClose:n}=e,[s,o]=(0,a.useState)(null);return((0,a.useEffect)(()=>{let e=L.find(e=>e.days===t);e?o(e.message):o(null)},[t]),s)?(0,r.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:(0,r.jsxs)("div",{className:"bg-gray-800 p-8 rounded-lg shadow-xl text-center text-gray-100 max-w-sm mx-auto",children:[(0,r.jsx)("h2",{className:"text-2xl font-bold mb-4",children:"Streak Milestone Achieved"}),(0,r.jsx)("p",{className:"mb-6",children:s}),(0,r.jsx)("button",{onClick:n,className:"px-6 py-2 bg-indigo-600 hover:bg-indigo-700 rounded-md text-white font-medium focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500",children:"Awesome"})]})}):null}function J(){let{status:e}=(0,s.useSession)(),[t,n]=(0,a.useState)(""),[o,l]=(0,a.useState)(""),[i,c]=(0,a.useState)(null),[m,g]=(0,a.useState)(!1),[h,p]=(0,a.useState)(0),x=(0,a.useMemo)(()=>[7,30,365,1461],[]);(0,a.useEffect)(()=>{let t=async()=>{let t=0,n=null;if("authenticated"===e)try{let e=await fetch("/api/streak");e.ok&&(t=(await e.json()).streak,n=new Date().toISOString().split("T")[0])}catch(e){console.error("Failed to fetch streak for auth user",e)}else if("unauthenticated"===e){let e=d();t=e.currentStreak,n=e.lastPostDate}p(t),x.includes(t)&&localStorage.getItem("jourin_last_shown_milestone")!=="".concat(t,"-").concat(n)&&(g(!0),localStorage.setItem("jourin_last_shown_milestone","".concat(t,"-").concat(n)))};return("authenticated"===e||"unauthenticated"===e)&&t(),window.addEventListener("storage",t),()=>{window.removeEventListener("storage",t)}},[e,x]);let y=async(t,r,a)=>{n(t),l(""),c({...r,timestamp:Date.now(),customTitles:a});let s=0,o=null;if("authenticated"===e)try{let e=await fetch("/api/streak",{method:"POST"});e.ok?(s=(await e.json()).streak,o=new Date().toISOString().split("T")[0]):console.error("Failed to update streak for authenticated user.")}catch(e){console.error("Error updating streak:",e)}else{await u();let e=d();s=e.currentStreak,o=e.lastPostDate}p(s),window.dispatchEvent(new Event("streakUpdated")),x.includes(s)&&localStorage.getItem("jourin_last_shown_milestone")!=="".concat(s,"-").concat(o)&&(g(!0),localStorage.setItem("jourin_last_shown_milestone","".concat(s,"-").concat(o)))},b=async()=>{try{await navigator.clipboard.writeText(t),l("Copied!"),setTimeout(()=>l(""),2e3)}catch(e){l("Failed to copy!"),console.error("Failed to copy prompt: ",e)}};return"loading"===e?(0,r.jsx)("div",{className:"flex justify-center items-center h-screen",children:"Loading..."}):(0,r.jsxs)("div",{className:"min-h-screen bg-gray-900 flex flex-col items-center justify-center py-12 px-4 sm:px-6 lg:px-8",children:[(0,r.jsxs)("div",{className:"max-w-md w-full space-y-8 text-center bg-gray-800 p-8 rounded-lg shadow-lg text-gray-100",children:[(0,r.jsx)(f,{}),(0,r.jsx)(D,{onPromptGenerated:y}),t&&(0,r.jsx)(T,{prompt:t,onCopy:b,copySuccess:o}),(0,r.jsx)(P,{newEntryToHistory:i})," "]}),m&&(0,r.jsx)(O,{streak:h,onClose:()=>g(!1)})]})}},2043:(e,t,n)=>{"use strict";n.d(t,{s:()=>r});let r=(e,t)=>{let n;return function(){for(var r=arguments.length,a=Array(r),s=0;s<r;s++)a[s]=arguments[s];clearTimeout(n),n=setTimeout(()=>e(...a),t)}}},5695:(e,t,n)=>{"use strict";var r=n(8999);n.o(r,"useRouter")&&n.d(t,{useRouter:function(){return r.useRouter}})},7062:(e,t,n)=>{Promise.resolve().then(n.bind(n,308))}},e=>{e.O(0,[108,671,441,964,358],()=>e(e.s=7062)),_N_E=e.O()}]);